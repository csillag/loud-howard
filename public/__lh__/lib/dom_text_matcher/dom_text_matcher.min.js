(function(){window.DomTextMatcher=function(){function t(t){this.mapper=t}return t.prototype.restrictToSerializable=function(t){return null==t&&(t=!0),this.mapper.restrictToSerializable(t)},t.prototype.setRootNode=function(t){return this.mapper.setRootNode(t)},t.prototype.setRootId=function(t){return this.mapper.setRootId(t)},t.prototype.setRootIframe=function(t){return this.mapper.setRootIframe(t)},t.prototype.setRealRoot=function(){return this.mapper.setRealRoot()},t.prototype.documentChanged=function(){return this.mapper.documentChanged()},t.prototype.getAllPaths=function(){var t,e,r;return e=this.timestamp(),t=this.mapper.getAllPaths(),r=this.timestamp(),{time:r-e,paths:t}},t.prototype.getDefaultPath=function(){return this.mapper.getDefaultPath()},t.prototype.prepareSearch=function(t){var e,r;return e=this.timestamp(),this.mapper.scan(t),r=this.timestamp(),r-e},t.prototype.searchExact=function(t,e,r,n){return null==e&&(e=!0),null==r&&(r=!1),null==n&&(n=null),this.pm||(this.pm=new window.DTM_ExactMatcher),this.pm.setDistinct(e),this.pm.setCaseSensitive(r),this.search(this.pm,t,null,n)},t.prototype.searchRegex=function(t,e,r){return null==e&&(e=!1),null==r&&(r=null),this.rm||(this.rm=new window.DTM_RegexMatcher),this.rm.setCaseSensitive(e),this.search(this.rm,t,null,r)},t.prototype.searchFuzzy=function(t,e,r,n,a,s){return null==r&&(r=!1),null==n&&(n=1e3),null==a&&(a=.5),null==s&&(s=null),null==this.dmp&&(this.dmp=new window.DTM_DMPMatcher),this.dmp.setMatchDistance(n),this.dmp.setMatchThreshold(a),this.dmp.setCaseSensitive(r),this.search(this.dmp,t,e,s)},t.prototype.search=function(t,e,r,n){var a,s,p,i,o,h,u,l,m,c,f=this;if(null==n&&(n=null),null==e)throw Error("Can't search for null pattern!");if(e=e.trim(),null==e)throw Error("Can't search an for empty pattern!");if(p=this.timestamp(),null!=n&&this.prepareSearch(n),i=this.timestamp(),null==this.mapper.corpus)throw Error("Not prepared to search! (call PrepareSearch, or pass me a path)");for(u=t.search(this.mapper.corpus,e,r),o=this.timestamp(),s=[],l=function(t){return s.push($.extend({},t,f.analyzeMatch(e,t),f.mapper.getMappingsForRange(t.start,t.end)))},m=0,c=u.length;c>m;m++)a=u[m],l(a);return h=this.timestamp(),{matches:s,time:{phase0_domMapping:i-p,phase1_textMatching:o-i,phase2_matchMapping:h-o,total:h-p}}},t.prototype.timestamp=function(){return(new Date).getTime()},t.prototype.analyzeMatch=function(t,e){var r;return r=this.mapper.corpus.substr(e.start,e.end-e.start),{found:r,exact:r===t}},t}()}).call(this);