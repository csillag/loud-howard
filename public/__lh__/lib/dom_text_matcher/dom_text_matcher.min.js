(function(){window.DomTextMatcher=function(){function t(t){this.mapper=t}return t.prototype.setRootNode=function(t){return this.mapper.setRootNode(t)},t.prototype.setRootId=function(t){return this.mapper.setRootId(t)},t.prototype.setRootIframe=function(t){return this.mapper.setRootIframe(t)},t.prototype.setRealRoot=function(){return this.mapper.setRealRoot()},t.prototype.documentChanged=function(){return this.mapper.documentChanged()},t.prototype.scan=function(){var t,e,r;return e=this.timestamp(),t=this.mapper.scan(),r=this.timestamp(),{time:r-e,data:t}},t.prototype.getDefaultPath=function(){return this.mapper.getDefaultPath()},t.prototype.searchExact=function(t,e,r,n){return null==e&&(e=!0),null==r&&(r=!1),null==n&&(n=null),this.pm||(this.pm=new window.DTM_ExactMatcher),this.pm.setDistinct(e),this.pm.setCaseSensitive(r),this.search(this.pm,t,null,n)},t.prototype.searchRegex=function(t,e,r){return null==e&&(e=!1),null==r&&(r=null),this.rm||(this.rm=new window.DTM_RegexMatcher),this.rm.setCaseSensitive(e),this.search(this.rm,t,null,r)},t.prototype.searchFuzzy=function(t,e,r,n,s,a){return null==r&&(r=!1),null==n&&(n=1e3),null==s&&(s=.5),null==a&&(a=null),null==this.dmp&&(this.dmp=new window.DTM_DMPMatcher),this.dmp.setMatchDistance(n),this.dmp.setMatchThreshold(s),this.dmp.setCaseSensitive(r),this.search(this.dmp,t,e,a)},t.prototype.search=function(t,e,r,n){var s,a,p,o,i,h,u,l,c,m,f=this;if(null==n&&(n=null),null==e)throw Error("Can't search for null pattern!");if(e=e.trim(),null==e)throw Error("Can't search an for empty pattern!");if(p=this.timestamp(),null!=n&&this.prepareSearch(n),o=this.timestamp(),null==this.mapper.corpus)throw Error("Not prepared to search! (call PrepareSearch, or pass me a path)");for(u=t.search(this.mapper.corpus,e,r),i=this.timestamp(),a=[],l=function(t){return a.push($.extend({},t,f.analyzeMatch(e,t),f.mapper.getMappingsForRange(t.start,t.end)))},c=0,m=u.length;m>c;c++)s=u[c],l(s);return h=this.timestamp(),{matches:a,time:{phase0_domMapping:o-p,phase1_textMatching:i-o,phase2_matchMapping:h-i,total:h-p}}},t.prototype.timestamp=function(){return(new Date).getTime()},t.prototype.analyzeMatch=function(t,e){var r;return r=this.mapper.corpus.substr(e.start,e.end-e.start),{found:r,exact:r===t}},t}()}).call(this);